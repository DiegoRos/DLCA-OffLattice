# DLCA Off-Lattice Project
  ## Author: Diego Rosenberg

## Description 
This code generates a DLCA cluster through a random collocation of particles and a random movement of these particles (which is dependent on their mass) to generate larger clusters. The movement of these particles is pseodorandom and is dependant on their mass (as would happen in a particle dynamics simulation). Along with this a restriction can be added so that particles can only stick if they have a coordination number of 0 or 1. Once clusters are formed they can separate two create two separate clusters during simulations. Once we achieve one of the conditions to stop the simulation, we measure the cluster's fractal dimension and if the cluster percolates the inteface. This can be repeated as many times as the user wants utilizing the ScriptDLCA.py or ScriptDLCAEdges.py.

## Files in the Repository:
- Code Files:
  - Includes all files necesary to run the code in ScriptDLCA.py or ScriptDLCAEdges.py and generate multiple results. These are made utilizing Python and C.
- Jupyter Notebook File:
  - Utilized to create the graphs seen in the final written reports.
- makefile
  - Utilized to compile C files (does not have to be utilized)
- PDF Files:
  - Include both the first half of project, which utilized strictly python code and did not have reversibility, as well as the second half of the project which utilized C and included reversibility.
- Misc:
  - README.md and .gitignore

## Code
This project is divided into three main files in charge of creting the cluster, one for measuring the fractal dimension of resultant clusters and another file responsible for measuring the probability of the cluster percolating.

- Creation of CCA Cluster (with and without reversibility):
  - [x] DLCA.c
- Measurment of Fractal Dimension: 
  - [x] FracDimDLCA.c
- Measurment of Fractal Percolation:
  - [x] PercolatesDLCA.c
- Extras:
  - [x] Unfold Cluster &#8594; TreeDLCA.py
  - [x] Center of Mass and Move to Center in Python &#8594; FunctionsDLCA.py
  - [x] Plot Clusters in Python &#8594; DlCAPlot.py 

## Files
### DLCA.h
Contains structures and imported libraries utilized in DLCA.c
- Imported Libraries:
  - <stdio.h>, <sys/stat.h>, <math.h>, <stdlib.h>, <time.h>
- Defined Constants:
  - Pi: 3.14159265358979
  - True: 1 
  - False: 0
- Defined values
  - Contains multiple definitions that if habilitated would change the simulation
    - These can be changed at compile time utilizing -D <CONST_NAME>=<val>
    - Options:
      - MAX_COORDINATION (this will make a block of optional code be activated that will limit the corrdination number of all particles)
      - GIF (this will create multiple csv files throughout the runtime of the code that can be processed by python after the simulation is complete. These can later be processed by python to generate graphs.)
      - RGINFO (This will create a csv that saves the radius of gyration information generated by the clusters through the simulation)
      - CLUSTER_NUMBER (This will create a csv that saves the number of clusters throught the simulation until the simulation is finished. These can later be processed by python to generate graphs.)
- Structures utilized in main code:
  - Stack
    - Variables:
      - int number &#8594; Saves number of particle.
      - Stack * next &#8594; Next node of stack
    - "Methods"
      - push &#8594; Adds a node to the stack; O(1)
      - pop &#8594; Removes the top node from the stack; O(1)
      - popVal &#8594; Removes a node with a specific value from the stack; O(n)
  - Circular Stack
    - Variables:
      - int number &#8594; Saves number of particle.
      - Stack * next, prev &#8594; Next and previous node of stack
    - "Methods"
      - push &#8594; Adds a node to the stack; O(1)
      - pop &#8594; Removes the top node from the stack; O(1)
      - get &#8594; Gets a value from the stack given a certain position; O(n)
  - Particle
    - Variables:
      - double x, y &#8594; Particle position
      - int number, index &#8594; Particle number (I.D.) and index (cluster I.D.)
      - int coordination_number &#8594; Number of particles connected to it
      - int k &#8594; Cell position of particle
    - "Methods" (Not actually methods but sets the value of a variable inside an instance of the struct)
      - void setK
        - args: struct Particle *particle
        - Description: Sets k value of a particle struct using its x and y position.
  - Cluster
    - Variables:
      - int mass &#8594; Mass of cluster
      - float cx, cy &#8594; Center of mass of cluster
      - float rg2 &#8594; Radius of Gyration squared of cluster

### DLCA.c
Contains the main code and is responsible for generating the clusters.
- Imports:
  - <DLCA.h>
- Functions:
  -  int main
    - args: int argc, char *argv[]
      - argv is necesary to execute the program in the command line (or as args if in a IDE), when running the program the folowing inputs are required as a minimum &#8594; &#60;Executable Name&#62; &#60;Number of Particles&#62; &#60;Lattice Size&#62;, while other two charactaristics can be altered &#60;Ring Size&#62; &#60;Progress&#62;, giving a total of 3 to 5 conditions that can be given to the program when running.
   - Description: This function will take in the inputs speficied in argv and create a completed (or in a state of equilibrium) DLCA cluster utilizing the following functions. This function prints the progress of the cluster to a file int the "Partial Results" directory and will print the finalized cluster to the "Results" directory. **(Note: Both of these directories are created at run time if they are not previously present)** The partial files have the name of PartialClusterSize& **#60;Lattice Size&#62;**Particles **&#60;Number of Particles&#62;**.csv while the final result has the form of ClusterSize **&#60;Lattice Size&#62;** Particles **&#60;Number of Particles&#62;**.csv
  - void runSim
    - args: None
    - Description: Takes in command line arguments and creates the simulaiton loop. This loop will stop depending on multiple conditions:
      - If reversibility is defined, code will stop after a certain number of steps (50 * lat_size * 10000000000) or (((prob_separate <= 0.15) && num_particles < 10000) ? (int)(lat_size * 1000000) : (int) (5 * lat_size * 1000000)) depending on what conditions are demanded.
      - If a maximum coordination number is defined then the code will either stop when there is only one cluster in existance or the previous preak condition is met. If both maximum coordination and reversibility are defined then the conditions for simple reversibility will apply.
      - If no maximum coordination or reversibility is defined (aka reversibility probability = 0) then the simulation will stop when there is only one cluster remaining.
  - void saveResults
    - args: None
    - Description: Takes the globally declared pointers of interest and save the position, index, and coordination number of all particles. This function is utilized for final results.
  - void allocate_memory
    - args: None
    - Description: Allocates memory to all of the pointer lists with the appropriate values.
  - void deallocate_memory
    - args: None
    - Description: Frees all memory created by the allocate_memory function.
  - void initialize
    - args: None
    - Description: First function ran in the procedure, creates all necesary structures and places all particles in the system (in such a way that none of the particles touch each other), as well as sets the mass_list, denominator and constant of normalization to initial values.
  - void setKlist
    - args: int k, int *kptr
    - Description: Function which returns the 9 cells that are neighbors of a given k cell. This is done so that the values are only calculated once throughout the entire procedure.
  - void addToCellList
    - args: struct Particle *particle
    - Description: Adds a particle's k to the Cell List to have a relative position of all the particles.
  - void resetCellListElement
    - args: struct Particle *particle
    - Description: Removes one particle from the cell list (to later be placed again after moving).
  - void resetParticleInLists
    - args: int number
    - Description: Removes one particle from the next particle list (since it separates from the cluster)
  - void removeParticleZ1List
    - args: int number
    - Description: Removes one particle from the list_z1 list since it has attached itself to another particle and no longer has a coordinatin number of 1.
  - void removeParticleZ1List
    - args: int number
    - Description: Adds one particle to the list_z1 list since it has deattached itself from a cluster and now has a coordinatin number of 1.
  - void changeDenominator
    - args: int mass1, int mass2
    - Description: When joining clusters the masses are joined to change the value of the denominator correspondingly.
  - void changeMassList
    - args: int mass1, int mass2
    - Description: When joining clusters the masses are joined and changed in the mass_list correspondingly.
  - void setA
    - args: None
    - Description: Sets the constant of normalization with the global denominator.
  - int selectClusterMass
    - args: None
    - Description: Selects a cluster to move or be separated in the run_sim() loop.
  - int checkSpot
    - args: double x, double y
    - Description: Function which takes a position and checks if this position is within interaction range of another particle. This function is utilized the first time particles are being placed in the system.
  - void step
    - args: int selected_cluster, double dir
    - Description: Given a cluster and a direction the cluster is moved in a specified direction, as well as changing cell_list and center of mass for the cluster accordingly.
  - void stepBack
    - args: int selected_cluster, double *odist, double dir
    - Description: Given a cluster, a direction, and a return distance the cluster is moved in a specified direction to remove overlap, as well as changing cell_list and center of mass of the cluster accordingly.
  - double periodicBoundaryConditions
    - args: double val
    - Description: If a particle is placed outside the periodic boundary conditions the function pushes it back on the opposite side.
  - int checkCluster
    - args: int selected_cluster, double dir, int *clusters, double *odist
    - Description: Given a cluster all values from *cluster and *odist are set to base values to then be compared, checks for every particle in the cluster.
  - void checkParticle
    - args: int selected_particle, double dir, int *checked_clusters, double *odist
    - Description: Chekcs if a particle from another cluster is in interaction range from it
  - float overlapDist
    - args: double dist, double dir, double p1x, double p1y, double p2x, double p2y
    - Description: Calculates the overlap distance of two neigboring particles. The formula is created utilizing a composition of triangles and other geometric tricks.
  - void joinClusters
    - args: int c1, int c2
    - Description: Function to join two clusters by index
  - void separateCluster
    - args: int number
    - Description: This funcition takes in the particle that will be separated from the cluster, since only particles with a coordination number of 1 can be separated this is the only input needed.
  - void posParticlesCluster
    - args: int lc_label, double *x_list, double *y_list
    - Description: Function that gives the position of all particles in a cluster utilizing the linked list
  - void centerOfMassTwoPoints
    - args: double *cx_list, double *cy_list, int *mass_list, double *cx, double *cy
    - Description: Calculates Center of mass for two points, or previous centers of masses. Then returns them in the cx and cy pointers.
  - void undoCenterOfMassTwoPoints
    - args: double *cx_list, double *cy_list, int *mass_list, double *cx, double *cy
    - Description: Creates the opposite calculation perfoermed in the centerOfMassTwoPoints function and gives the new center of mass of a cluster after a particle separates.
  - double radiusOfGyration
    - args: int lc_mass, int sc_mass, int lc_label, int sc_label, double *cx_new, double *cy_new
    - Description: Calculates the radius of gyration of two clusters after combining. Then returns them in the cx_new and cy pointers.
  - double undoRadiusOfGyration
    - args: int lc_mass, int sc_mass, int lc_label, int sc_label, double *cx_new, double *cy_new
    - Description: Calculates the opposite of the radiusOfGyration function and gives the radius of gyration of a cluster after a single particle separates. Then returns them in the cx_new and cy pointers.
  - void resetRgFile
    - args: None
    - Description: Deletes the existing rg file and creates a new blank csv to write on.
  - void writeRgFile
    - args: None
    - Description: Writes the current radius of gyration for all clusters in the simulation (can be utilized at any point during the sim).
  - void resetNumberFile
    - args: None
    - Description: Deletes the existing Cluster Number file and creates a new blank csv to write on.
  - void writeNumberFile
    - args: None
    - Description: Writes the current mass of all clusters in the simulation (can be utilized at any point during the sim).

### FracDimDLCA.c
- This code will calculate the fractal dimension for a 2D cluster that is off-lattice or on-lattice. This will be done utilizing two methods, from these the average will represent the fractal dimension. The methods are:
  1. The absolute value of the slope of the linear regression between logarithm of the box size vs logarithm the average particles per box.
  2. The absolute value of the slope of the linear regression of the logarithm box size vs logarithm number of boxes.
- Imoprted Libraries:
  - &#60;stdio.h&#62;, &#60;sys/stat.h&#62;, &#60;math.h&#62;, &#60;stdlib.h&#62;, &#60;time.h&#62;, &#60;string.h&#62;
- Functions:
  - int main
    - args: int argc, char *argv[]
      - When executing the compiled file there have to be three entries without including the executable name, resulting in 4 total entries, these are: &#60;Executable Name&#62; &#60;Lattice Size&#62; &#60;Number of Particles&#62; &#60;File Name&#62;. 
    - Description: Taking the argv entries the size of the box_counts, avg_counts and box_size pointer lists are calculated, then the fractal dimension function function is called and the returned value, along with the resulting lists (not the logaritmic values) are saved to a file in the Results directory with the format: FracDimDCountsSize **&#60;Lattice Size&#62;** Particles **&#60;Number of Particles&#62;**.csv and the fractal dimension is saved to: FracDimSize **&#60;Lattice Size&#62;** Particles **&#60;Number of Particles&#62;**.txt
  - void allocate_memory
    - args: None
    - Description: Allocates memory to all of the pointer lists with the appropriate values.
  - void deallocate_memory
    - args: None
    - Description: Frees all memory created by the allocate_memory function.
  - double fractalDimension
    - args: double *x, double *y
    - Description: Calculates the fractal dimension utilizing the global pointer lists named box_counts, avg_counts and box_size.
  - void fractalDimensionCounts
    - args: double *x, double *y
    - Perfomrs the box count and average count methods to the lists of x and y sent in, the results are stored in the global pointer lists box_counts, avg_counts and box_size.
  - void linearReg
    - args: int n, double *x, double *y, double *m, double *b
    - Description: returns 2 floating point values which are the slope and intercept respectively, these values are returned in the m and b pointers.

### PercolatesDLCA.c
- This code will check every row and every column of the system to revise if a given cluster percolates the system, if all of the columns are filled by at least one particle the cluster will percolate in x, and if all rows are filled by at least one particle the cluster will percolate in the y direction.

### TreeDLCA.py
- Will utilize a completed (with only one final cluster) simulation and remove the periodic boundary conditions of the system so that a full view of the unfolded cluster can be seen.